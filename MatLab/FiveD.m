clear
clc

data = [
    0       4.081		
    0       3.858
    0       3.847
    0.0001	4.094		
    0.0001  3.848
    0.0001  3.642
    0.001	4.593		
    0.001   4.28
    0.001   4.174
    0.01	5.448		
    0.01    5.829
    0.01    5.793
    0.1 	9.293	
    0.1     8.992
    0.1     7.439
    1       12.392		
    1       10.463
    1       10.193
    10      13.953		
    10      10.293
    10      10.293];

WIN = data(:,1)*1000;
LU = data(:,2);

P = 20
R = 50

fun = @(F) (0.5*(F(1)+R+P-sqrt((F(1)+R+P)^2-4*R*P))-LU);
[A] = lsqnonlin(fun,[2]);
K2 = A(1)

fun = @(F) (0.5*F(1)+F(1)*K2/(2*R-F(1))+ (F(1)*F(2)*K2/(2*R-F(1)))/(R-F(1)*K2/(2*R-F(1))-0.5*F(1))-56);
[B] = lsqnonlin(fun,[11.513 100]);
Cmax = B(1)
K1 = B(2)

